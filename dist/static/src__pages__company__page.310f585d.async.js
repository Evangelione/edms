webpackJsonp([23],{aQN9:function(e,t,a){"use strict";function n(e){var t=e.company;return{companyDetail:t.companyDetail,imgUrl:t.imgUrl,loading:e.loading.models.company}}function l(e){var t=e.company;return{list:t.list,page:t.page,total:t.total,find_str:t.find_str,loading:e.loading.models.company}}Object.defineProperty(t,"__esModule",{value:!0});var i=(a("jIi2"),a("hRRF")),r=a("Z60a"),o=a.n(r),s=a("j/rp"),c=a.n(s),p=a("C9uT"),m=a.n(p),d=a("T/v0"),u=a.n(d),h=a("tNLN"),y=a.n(h),f=(a("LHBr"),a("A+AJ")),g=(a("yQBS"),a("qA/u")),b=a("GiK3"),E=a.n(b),v=a("S6G3"),C=(a("faxx"),a("FV1P")),_=(a("JYrs"),a("QoDT")),x=(a("crfj"),a("zwGx")),w=a("lt8z"),S=a.n(w),k=(a("sRCI"),a("vnWH")),D=(a("scXE"),a("DYcq")),L=(a("baa2"),a("FC3+")),N=(a("UQ5M"),a("/qCn")),P=a("Cenh"),I=a.n(P),F=(a("cwkc"),a("8/ER")),q=(a("gZEk"),a("8rR3")),U=a("fuCS"),V=a.n(U),R=a("oiih"),j=q.a.Item,G=F.a.Option,J=function(e){function t(e){var a;return o()(this,t),a=u()(this,y()(t).call(this,e)),a.saveForm=function(){a.props.form.validateFields(function(e,t){e||(a.setState({submitLoading:!0}),a.props.imgUrl.length?t.certificate=I()(a.props.imgUrl):t.certificate=I()(t.certificate),a.props.dispatch({type:"company/modifyCompany",payload:{form:t}}).then(function(){a.setState({editable:!1,submitLoading:!1})}))})},a.editForm=function(){a.setState({editable:!0})},a.cacelForm=function(){a.props.form.resetFields(),a.setState({editable:!1})},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a.handleRemove=function(e){var t=a.props.imgUrl;if("string"==typeof t&&(t=Array(t)),t.splice(t.findIndex(function(t){return t===e}),1),a.props.dispatch({type:"company/saveImg",payload:{imgUrl:I()(t)}}),!a.state.editable)return!1},a.handleChange=function(e){var t=e.fileList;return a.setState({fileList:t})},a.beforeUpload=function(e){var t="image/jpeg"===e.type,a="image/png"===e.type;return e.size/1024/1024<2&&(t||a)?void 0:(N.a.error("\u4ec5\u652f\u6301JPG\u3001PNG\u683c\u5f0f\uff0c\u6587\u4ef6\u5c0f\u4e8e2MB!"),!1)},a.customRequest=function(e){a.props.dispatch({type:"company/postImg",payload:e})},a.state={editable:!1,previewVisible:!1,previewImage:"",fileList:[],submitLoading:!1},a}return m()(t,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.props.dispatch({type:"company/fetchCompanyDetail"}).then(function(){if(!e.props.companyDetail.certificate)return!1;e.props.dispatch({type:"company/saveImg",payload:{imgUrl:e.props.companyDetail.certificate}});var t=[],a=JSON.parse(e.props.companyDetail.certificate);"string"==typeof a&&(a=Array(a)),a.forEach(function(e,a){t.push({uid:a,name:"xxx.png",status:"done",url:e})}),e.setState({fileList:t},function(){console.log(e.state.fileList)})})}},{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,l=this.props.form.getFieldDecorator,i={labelCol:{span:2},wrapperCol:{span:5}},r=E.a.createElement("div",null,E.a.createElement(L.a,{type:"plus"}),E.a.createElement("div",{className:"ant-upload-text"},"\u4ec5\u652f\u6301JPG\u3001PNG\u683c\u5f0f\uff0c\u6587\u4ef6\u5c0f\u4e8e2MB"));return E.a.createElement(q.a,{style:{margin:"0 30px"}},E.a.createElement("div",{className:V.a.title},"1.\u8bc1\u4ef6\u4fe1\u606f"),E.a.createElement(j,{labelCol:{span:2},wrapperCol:{span:20},label:"\u8bc1\u4ef6\u7167\u7247"},l("certificate",{initialValue:["http://lch-img.oss-cn-beijing.aliyuncs.com/lch-bill20180801094752u0.png"],rules:[{required:!0,message:"Please input your note!"}]})(E.a.createElement("div",null,E.a.createElement("div",{className:"clearfix"},E.a.createElement(D.a,{accept:".jpg,.png",name:"CompanyForm[img]",action:"".concat(R.a,"/home/company/img"),listType:"picture-card",className:"avatar-uploader",fileList:n,onPreview:this.handlePreview,onRemove:this.handleRemove,onChange:this.handleChange,beforeUpload:this.beforeUpload,customRequest:this.customRequest},n.length>=5||!this.state.editable?null:r),E.a.createElement(k.a,{visible:t,footer:null,onCancel:this.handleCancel},E.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))))),E.a.createElement("div",{className:V.a.title},"2.\u516c\u53f8\u4fe1\u606f"),E.a.createElement(j,S()({},i,{label:"\u516c\u53f8\u5168\u79f0"}),l("full_name",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.full_name})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u516c\u53f8\u5168\u79f0\uff08\u5408\u540c\u540d\u79f0\uff09",disabled:!this.state.editable}))),E.a.createElement(j,S()({},i,{label:"\u6cd5\u5b9a\u4ee3\u8868\u4eba"}),l("corporation",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.corporation})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u6cd5\u5b9a\u4ee3\u8868\u4eba\u59d3\u540d",disabled:!this.state.editable}))),E.a.createElement(j,S()({},i,{label:"\u529e\u516c\u5730\u5740"}),l("addr",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.addr})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u8be6\u7ec6\u529e\u516c\u5730\u5740",disabled:!this.state.editable}))),E.a.createElement(j,S()({},i,{label:"\u516c\u53f8\u56fa\u8bdd"}),l("fixed_telephone",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.fixed_telephone})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u516c\u53f8\u56fa\u8bdd",disabled:!this.state.editable}))),E.a.createElement("div",{className:V.a.title},"3.\u8054\u7cfb\u65b9\u5f0f"),E.a.createElement(j,S()({},i,{label:"\u8054\u7cfb\u4eba"}),l("contact",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.contact})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d",disabled:!this.state.editable}))),E.a.createElement(j,S()({},i,{label:"\u624b\u673a\u53f7"}),l("contact_mobile",{rules:[{required:!0,message:"Please input your note!"}],initialValue:this.props.companyDetail.contact_mobile})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u624b\u673a\u53f7",disabled:!this.state.editable}))),E.a.createElement("div",{className:V.a.title},"4.\u516c\u53f8\u7c7b\u578b"),E.a.createElement(j,S()({},i,{label:"\u8bf7\u9009\u62e9\u516c\u53f8\u7c7b\u578b"}),l("company_type",{initialValue:this.props.companyDetail.company_type})(E.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9\u516c\u53f8\u7c7b\u578b",style:{width:150},disabled:!this.state.editable},E.a.createElement(G,{value:"0"},"\u6682\u65e0\u7c7b\u578b"),E.a.createElement(G,{value:"1"},"\u8d38\u6613\u5546"),E.a.createElement(G,{value:"2"},"\u8fd0\u8d38\u5546"),E.a.createElement(G,{value:"3"},"\u6db2\u5382"),E.a.createElement(G,{value:"4"},"\u63a5\u6536\u7ad9"),E.a.createElement(G,{value:"5"},"\u5176\u5b83")))),E.a.createElement(C.a,{style:{width:500,margin:"42px 0 20px 85px"}},this.state.editable?E.a.createElement("div",null,E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{type:"primary",style:{width:100},onClick:this.saveForm,loading:this.state.submitLoading},"\u4fdd\u5b58")),E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{className:"grayButton",style:{width:100},onClick:this.cacelForm},"\u53d6\u6d88"))):E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{type:"primary",style:{width:100},onClick:this.editForm},"\u7f16\u8f91"))))}}]),c()(t,e),t}(E.a.Component),B=Object(v.connect)(n)(q.a.create()(J)),K=(a("GKDd"),a("BJfm")),O=(a("HCp1"),a("GWr5")),T=function(e){function t(e){var a;return o()(this,t),a=u()(this,y()(t).call(this,e)),a.pageChangeHandler=function(e){a.props.dispatch({type:"company/fetchCompanyList",payload:{page:e,find_str:a.props.find_str}})},a.state={},a}return m()(t,[{key:"render",value:function(){var e=this.props,t=e.list,a=e.page,n=e.total,l=e.loading,i=[{title:"\u59d3\u540d",dataIndex:"name",key:"name",align:"center"},{title:"\u89d2\u8272",dataIndex:"role",key:"role",align:"center"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile",key:"mobile",align:"center"},{title:"\u603b\u6210\u4ea4\u5ba2\u6237\u6570\u91cf",dataIndex:"customer_num",key:"customer_num",align:"center"},{title:"\u603b\u6210\u4ea4\u8ba2\u5355\u91cf",dataIndex:"count(o.id)",key:"count(o.id)",align:"center"},{title:"\u603b\u9500\u552e\u91d1\u989d",dataIndex:"all_sale_money",key:"all_sale_money",align:"center",render:function(e,t,a){return"\uffe5".concat((e-0).toFixed(2))}}];return E.a.createElement("div",null,E.a.createElement(O.a,{columns:i,dataSource:t,rowKey:function(e){return e.salerperson_id},pagination:!1,loading:l}),E.a.createElement(K.a,{className:"ant-table-pagination",current:a,total:n,pageSize:R.c,onChange:this.pageChangeHandler}))}}]),c()(t,e),t}(E.a.Component),A=Object(v.connect)(l)(T),H=a("8O4S"),z=g.a.TabPane,M=f.a.Search,Q=function(e){function t(e){var a;return o()(this,t),a=u()(this,y()(t).call(this,e)),a.callback=function(e){a.setState({paneKey:e}),"2"===e&&a.props.dispatch({type:"company/fetchCompanyList",payload:{page:1,find_str:""}})},a.iptSearch=function(e){a.props.dispatch({type:"company/fetchCompanyList",payload:{page:1,find_str:e}})},a.state={paneKey:"1"},a}return m()(t,[{key:"render",value:function(){return E.a.createElement(H.a,null,"2"===this.state.paneKey?E.a.createElement("div",{className:"searchBox"},E.a.createElement(M,{style:{width:260,marginLeft:10},placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u8fdb\u884c\u67e5\u8be2",onSearch:this.iptSearch})):"",E.a.createElement(g.a,{onChange:this.callback},E.a.createElement(z,{tab:"\u516c\u53f8\u4fe1\u606f",key:"1"},E.a.createElement(i.a,{style:{paddingTop:30}},E.a.createElement(B,null))),E.a.createElement(z,{tab:"\u9500\u552e\u4e1a\u7ee9",key:"2"},E.a.createElement(i.a,{style:{paddingTop:30}},E.a.createElement(A,null)))))}}]),c()(t,e),t}(E.a.Component);t.default=Object(v.connect)()(Q)},fuCS:function(e,t){e.exports={title:"title___3KJHz"}}});