webpackJsonp([23],{aQN9:function(e,a,t){"use strict";function n(e){var a=e.company;return{companyDetail:a.companyDetail,imgUrl:a.imgUrl,loading:e.loading.models.company}}function l(e){var a=e.company;return{list:a.list,page:a.page,total:a.total,find_str:a.find_str,loading:e.loading.models.company}}Object.defineProperty(a,"__esModule",{value:!0});var i=(t("jIi2"),t("hRRF")),r=t("Z60a"),c=t.n(r),s=t("j/rp"),o=t.n(s),p=t("C9uT"),m=t.n(p),d=t("T/v0"),u=t.n(d),h=t("tNLN"),y=t.n(h),f=(t("LHBr"),t("A+AJ")),g=(t("yQBS"),t("qA/u")),b=t("GiK3"),E=t.n(b),v=t("S6G3"),C=(t("faxx"),t("FV1P")),_=(t("JYrs"),t("QoDT")),x=(t("crfj"),t("zwGx")),w=t("lt8z"),S=t.n(w),k=(t("sRCI"),t("vnWH")),D=(t("scXE"),t("DYcq")),L=(t("baa2"),t("FC3+")),N=(t("UQ5M"),t("/qCn")),I=t("Cenh"),F=t.n(I),q=(t("cwkc"),t("8/ER")),U=(t("gZEk"),t("8rR3")),V=t("fuCS"),R=t.n(V),j=t("oiih"),P=U.a.Item,G=q.a.Option,B=function(e){function a(e){var t;return c()(this,a),t=u()(this,y()(a).call(this,e)),t.saveForm=function(){t.props.form.validateFields(function(e,a){e||(t.setState({submitLoading:!0}),t.props.imgUrl.length?a.certificate=F()(t.props.imgUrl):a.certificate=F()(a.certificate),t.props.dispatch({type:"company/modifyCompany",payload:{form:a}}).then(function(){t.setState({editable:!1,submitLoading:!1})}))})},t.editForm=function(){t.setState({editable:!0})},t.cacelForm=function(){t.props.form.resetFields(),t.setState({editable:!1})},t.handleCancel=function(){return t.setState({previewVisible:!1})},t.handlePreview=function(e){t.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},t.handleRemove=function(e){var a=t.props.imgUrl;if("string"==typeof a&&(a=Array(a)),a.splice(a.findIndex(function(a){return a===e}),1),t.props.dispatch({type:"company/saveImg",payload:{imgUrl:F()(a)}}),!t.state.editable)return!1},t.handleChange=function(e){var a=e.fileList;return t.setState({fileList:a})},t.beforeUpload=function(e){var a="image/jpeg"===e.type,t="image/png"===e.type;return e.size/1024/1024<5&&(a||t)?void 0:(N.a.error("\u4ec5\u652f\u6301JPG\u3001PNG\u683c\u5f0f\uff0c\u6587\u4ef6\u5c0f\u4e8e5MB!"),!1)},t.customRequest=function(e){t.props.dispatch({type:"company/postImg",payload:e})},t.state={editable:!1,previewVisible:!1,previewImage:"",fileList:[],submitLoading:!1},t}return m()(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.props.dispatch({type:"company/fetchCompanyDetail"}).then(function(){if(!e.props.companyDetail.certificate)return!1;e.props.dispatch({type:"company/saveImg",payload:{imgUrl:e.props.companyDetail.certificate}});var a=[],t=JSON.parse(e.props.companyDetail.certificate);"string"==typeof t&&(t=Array(t)),t.forEach(function(e,t){a.push({uid:t,name:"xxx.png",status:"done",url:e})}),e.setState({fileList:a},function(){console.log(e.state.fileList)})})}},{key:"render",value:function(){var e=this.state,a=e.previewVisible,t=e.previewImage,n=e.fileList,l=this.props.form.getFieldDecorator,i={labelCol:{span:2},wrapperCol:{span:5}},r=E.a.createElement("div",null,E.a.createElement(L.a,{type:"plus"}),E.a.createElement("div",{className:"ant-upload-text"},"\u4ec5\u652f\u6301JPG\u3001PNG\u683c\u5f0f\uff0c\u6587\u4ef6\u5c0f\u4e8e2MB"));return E.a.createElement(U.a,{style:{margin:"0 30px"}},E.a.createElement("div",{className:R.a.title},"1.\u8bc1\u4ef6\u4fe1\u606f"),E.a.createElement(P,{labelCol:{span:2},wrapperCol:{span:20},label:"\u8bc1\u4ef6\u7167\u7247"},l("certificate",{initialValue:["http://lch-img.oss-cn-beijing.aliyuncs.com/lch-bill20180801094752u0.png"],rules:[{required:!0,message:"\u8bf7\u4e0a\u4f20\u8bc1\u4ef6\u7167!"}]})(E.a.createElement("div",null,E.a.createElement("div",{className:"clearfix"},E.a.createElement(D.a,{accept:".jpg,.png",name:"CompanyForm[img]",action:"".concat(j.a,"/home/company/img"),listType:"picture-card",className:"avatar-uploader",fileList:n,onPreview:this.handlePreview,onRemove:this.handleRemove,onChange:this.handleChange,beforeUpload:this.beforeUpload,customRequest:this.customRequest},n.length>=5||!this.state.editable?null:r),E.a.createElement(k.a,{visible:a,footer:null,onCancel:this.handleCancel},E.a.createElement("img",{alt:"example",style:{width:"100%"},src:t})))))),E.a.createElement("div",{className:R.a.title},"2.\u516c\u53f8\u4fe1\u606f"),E.a.createElement(P,S()({},i,{label:"\u516c\u53f8\u5168\u79f0"}),l("full_name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u516c\u53f8\u5168\u79f0!"}],initialValue:this.props.companyDetail.full_name})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u516c\u53f8\u5168\u79f0\uff08\u5408\u540c\u540d\u79f0\uff09",disabled:!this.state.editable}))),E.a.createElement(P,S()({},i,{label:"\u6cd5\u5b9a\u4ee3\u8868\u4eba"}),l("corporation",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6cd5\u5b9a\u4ee3\u8868\u4eba!"}],initialValue:this.props.companyDetail.corporation})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u6cd5\u5b9a\u4ee3\u8868\u4eba\u59d3\u540d",disabled:!this.state.editable}))),E.a.createElement(P,S()({},i,{label:"\u529e\u516c\u5730\u5740"}),l("addr",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8be6\u7ec6\u529e\u516c\u5730\u5740!"}],initialValue:this.props.companyDetail.addr})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u8be6\u7ec6\u529e\u516c\u5730\u5740",disabled:!this.state.editable}))),E.a.createElement(P,S()({},i,{label:"\u516c\u53f8\u56fa\u8bdd"}),l("fixed_telephone",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u516c\u53f8\u56fa\u8bdd!"}],initialValue:this.props.companyDetail.fixed_telephone})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u516c\u53f8\u56fa\u8bdd",disabled:!this.state.editable}))),E.a.createElement("div",{className:R.a.title},"3.\u8054\u7cfb\u65b9\u5f0f"),E.a.createElement(P,S()({},i,{label:"\u8054\u7cfb\u4eba"}),l("contact",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d!"}],initialValue:this.props.companyDetail.contact})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u8054\u7cfb\u4eba\u59d3\u540d",disabled:!this.state.editable}))),E.a.createElement(P,S()({},i,{label:"\u624b\u673a\u53f7"}),l("contact_mobile",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u624b\u673a\u53f7!"}],initialValue:this.props.companyDetail.contact_mobile})(E.a.createElement(f.a,{placeholder:"\u8bf7\u586b\u5199\u624b\u673a\u53f7",disabled:!this.state.editable}))),E.a.createElement("div",{className:R.a.title},"4.\u516c\u53f8\u7c7b\u578b"),E.a.createElement(P,S()({},i,{label:"\u8bf7\u9009\u62e9\u516c\u53f8\u7c7b\u578b"}),l("company_type",{initialValue:this.props.companyDetail.company_type})(E.a.createElement(q.a,{placeholder:"\u8bf7\u9009\u62e9\u516c\u53f8\u7c7b\u578b",style:{width:150},disabled:!this.state.editable},E.a.createElement(G,{value:"0"},"\u6682\u65e0\u7c7b\u578b"),E.a.createElement(G,{value:"1"},"\u8d38\u6613\u5546"),E.a.createElement(G,{value:"2"},"\u8fd0\u8d38\u5546"),E.a.createElement(G,{value:"3"},"\u6db2\u5382"),E.a.createElement(G,{value:"4"},"\u63a5\u6536\u7ad9"),E.a.createElement(G,{value:"5"},"\u5176\u5b83")))),E.a.createElement(C.a,{style:{width:500,margin:"42px 0 20px 85px"}},this.state.editable?E.a.createElement("div",null,E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{type:"primary",style:{width:100},onClick:this.saveForm,loading:this.state.submitLoading},"\u4fdd\u5b58")),E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{className:"grayButton",style:{width:100},onClick:this.cacelForm},"\u53d6\u6d88"))):E.a.createElement(_.a,{span:5,offset:2},E.a.createElement(x.a,{type:"primary",style:{width:100},onClick:this.editForm},"\u7f16\u8f91"))))}}]),o()(a,e),a}(E.a.Component),J=Object(v.connect)(n)(U.a.create()(B)),O=(t("GKDd"),t("BJfm")),T=(t("HCp1"),t("GWr5")),A=function(e){function a(e){var t;return c()(this,a),t=u()(this,y()(a).call(this,e)),t.pageChangeHandler=function(e){t.props.dispatch({type:"company/fetchCompanyList",payload:{page:e,find_str:t.props.find_str}})},t.state={},t}return m()(a,[{key:"render",value:function(){var e=this.props,a=e.list,t=e.page,n=e.total,l=e.loading,i=[{title:"\u59d3\u540d",dataIndex:"name",key:"name",align:"center"},{title:"\u89d2\u8272",dataIndex:"role",key:"role",align:"center"},{title:"\u624b\u673a\u53f7\u7801",dataIndex:"mobile",key:"mobile",align:"center"},{title:"\u603b\u6210\u4ea4\u5ba2\u6237\u6570\u91cf",dataIndex:"customer_num",key:"customer_num",align:"center"},{title:"\u603b\u6210\u4ea4\u8ba2\u5355\u91cf",dataIndex:"count(o.id)",key:"count(o.id)",align:"center"},{title:"\u603b\u9500\u552e\u91d1\u989d",dataIndex:"all_sale_money",key:"all_sale_money",align:"center",render:function(e,a,t){return"\uffe5".concat((e-0).toFixed(2))}}];return E.a.createElement("div",null,E.a.createElement(T.a,{columns:i,dataSource:a,rowKey:function(e){return e.salerperson_id},pagination:!1,loading:l}),E.a.createElement(O.a,{className:"ant-table-pagination",current:t,total:n,pageSize:j.c,onChange:this.pageChangeHandler}))}}]),o()(a,e),a}(E.a.Component),K=Object(v.connect)(l)(A),H=t("8O4S"),M=g.a.TabPane,z=f.a.Search,Q=function(e){function a(e){var t;return c()(this,a),t=u()(this,y()(a).call(this,e)),t.callback=function(e){t.setState({paneKey:e}),"2"===e&&t.props.dispatch({type:"company/fetchCompanyList",payload:{page:1,find_str:""}})},t.iptSearch=function(e){t.props.dispatch({type:"company/fetchCompanyList",payload:{page:1,find_str:e}})},t.state={paneKey:"1"},t}return m()(a,[{key:"render",value:function(){return E.a.createElement(H.a,null,"2"===this.state.paneKey?E.a.createElement("div",{className:"searchBox"},E.a.createElement(z,{style:{width:260,marginLeft:10},placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u8fdb\u884c\u67e5\u8be2",onSearch:this.iptSearch})):"",E.a.createElement(g.a,{onChange:this.callback},E.a.createElement(M,{tab:"\u516c\u53f8\u4fe1\u606f",key:"1"},E.a.createElement(i.a,{style:{paddingTop:30}},E.a.createElement(J,null))),E.a.createElement(M,{tab:"\u9500\u552e\u4e1a\u7ee9",key:"2"},E.a.createElement(i.a,{style:{paddingTop:30}},E.a.createElement(K,null)))))}}]),o()(a,e),a}(E.a.Component);a.default=Object(v.connect)()(Q)},fuCS:function(e,a){e.exports={title:"title___1Bym5"}}});